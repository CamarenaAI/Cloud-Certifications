# On Prem vs Cloud

| On Prem | Cloud |
| -------------------- | -------------------- |
| You know where your data is | You have to trust the location of your data |
| The physical location of your data is limited to places you own | The location of your data can be worldwide |
| You are in full control security | You have to trust your data's security, to an extent |
| You are responsible for paying for the physical server boxes | Your cloud provider pays for the physical server box, and you pay "rent" for the server |
| To upgrade your memory, cores, hard drive space requires planning and purchase of equipment and probably several days/weeks | To upgrade your memory cores, hard drive space requieres a click on a few button and a few minutes |
| Capital Expenditure (CAPital EXpenditure) | Operational Expenses (OPerational EXpenditure) |
| You are responsible for doing hardware maintenance or upgrades | Your cloud provider applies any hardware mainteance or upgrades |
| You are responsible for doing any software updates | Maybe you, maybe your cloud provider are responsible for doing any software upgrades |

# IaaS - PaaS - SaaS
## Infraestructure as a Service (IaaS)
Iaas is the mosty flexible category of cloud services

## Platform as a Service (PaaS)
PaaS solution requires less user management and does not provide access to the operating system

## Software as a Service (SaaS)
SaaS solution requieres the least management

### Examples of Azure Services Types
| IaaS | PaaS | SaaS |
| ---------- | ---------- | ---------- |
| Azure virtual machines | Azure App Service | Outlook email |
| Azure Storage accounts | Azure SQL DataBaes | Calendar |
|  | Azure Cosmos DB | Microsoft Office 365 |
|  | Azure Sypnapse Analytics |  |

# Creating Azure SQL Database
- Login in Azure Portal https://portal.azure.com/#home
- Click on SQL databases/Add

## Create SQL Database
### Basics
#### Project details
Select the subscription to manage deployed resources and cost. Use resource groups like folders to organize and \
manage all your resources
- Subscription: Select your subscription
- Resource group: Select your resource group, if you don't have resource group Click on Create new

#### Database details
Enter required settings for this database, including picking a logical server and configuring the compute and storage \
manage all your resources
- Database name: Enter database name
- Server: Select a server, if you don't have server Click on Create new
    - Create new Server:
        - Server name: Enter server name
        - Server admin login: Enter server admin login
        - Password: Create a password
        - Confirm password: Confirm the password
        - Location: Select the location
- Want to use SQL elastic pool? Yes/No
    - Elastic pools a simple and cost effective solution for managing the performance of
      multiple databases within a fixed budget. An elastic pool provides compute (eDTUs) and
      storage resources that are shared between all the databases it contains. Databases within a
      pool only use the resources they need, when they need them, within configurable limits. The
      price of a pool is based only on the amount of resources configured and is independent of the
      number of databases it contains
- Compute + Storage: Configure database
    - Basic: For less demanding workloads
    - Standard: For workloads with typical performance requirements
    - Premium: For IO-intensive workloads
    - General Purpose: Scalable compute and storage options
    - Hyperscale: On-demand scalable storage
    - Bussines Critical: High transaction rate and high resilency

### Networking
#### Firewall rules
The settings displayed below are read only. They can be modified from the "Firewalls and virtual networks" blade after \
database creation

#### Private endpoints
Private endpoints connection are associated with a private IP address within a Virtual Network. The list below showss all \
the private endpoint connections for this server. Note that private endpoint connections are defined at the server level \
and they provide access to all databases in the server

### Additional settings
#### Data source
Start with a blank database, restore from a backup or select sample data to populate your new database
- Use existing data: None/Backup/Sample

#### Database collation
Database collation defines the rules that sort and compare data and cannot be changed after database creation. The \
default database collation is SQL_Latin1_General_CP1_CI_AS
- Collation: Find a collation

#### Azure Defender for SQL
Protect your data using Azure Defender for SQL a unified security package including vulnerability assessment and \
advance threat protection for you server
- Get started with 30 day free trial period, and then 11,179635 GBP/server/month
- Enable Azure Defender for SQL: Start free trial/Not now

## Describe database service: Azure SQL Database
- Provides:
    - Automatic patches and backups:
        - Full backup every week, differential 12-14 hours, transaction log 5-10 minutes (not adjustable). 
        - Long-term retention: weekly, monthly and/or yearly full backups for up to 10 years in Blob storage
- Point-in-time restores for up to 7 days (adjustable to 1 to 35 days - 1 to 7 for Basics).
- Active geo-replication (up to 4 readable secondary databases)
- Auto-failover groupsz
- Avanced threat protection
- Encryption:
    - Protect data in motion, TLS - Transport Layer Security
    - Encrypt data at rest, TDE- Transparent Data Encryption (on by default)
    - Limit access to Data in use, Always Encrypted (encrypt some plain text columns)
    - Hide parts of data (e.g. credit cards), Dynamic data masking
- Zone-redundat databases (availability zones)
- 99.99% high availability guarentee
- PaaS
- Choose Single DataBase or Elastic Pool:
    - Single DataBase can be provisioned, or serverless on General Purpose tier only
    - Elastic Pool - shared performance resources
    - You can move databases in android in and out of elastic pools
- Quickly rescale resources for database/pool - no need to restar the database: 1-80 vCores, 32 Gb - 4 Tb (up to 1 Tb in China and Germany)
- Three services tiers:
    - General Purposes/Standard (the general service tier)
    - Bussines Critical/Premium
    - Hyperscale - up to 100 Tb 
- Mostly compatible with on prem version of SQL Server
- Does not support:
    - Linked servers
    - Service Broker
    - Database Mail
- Acces database using:
    - SQL Server Management Studio (SSMS)
    - Azure Data Studio
    - Visual Studio (including SQL Server Data Tools)
- Manage database using Azure Portal (web):
    - Adjust data storage size
    - Number of available cores

# Describe Azure SQL Managed Instance
- SQL Server in the cloud - not just one database
- Nearly 100% compatible with on prem version of SQL Server Enterprise Edition, including linked servers
- Lift-and-shift supported
- Provides:
    - Operating system and Database Installation and Patching
    - Dynamic Resizing
    - Data replication
    - High availability configuration
    - Access using Azure Active Directory credentials, tied to your current sign-in
    - Backups and point-in-time restores - same as Azure SQL Database, but only to SQL Managed Instance - not to SQL Server instance or Azure SQL Database 
- Access database using SQL Server Management Studio (SSMS) or Azure Data

# Describe SQL Server on Azure Virtual Machines
- A full version of Windows running a full version of SQL Server
- IaaS - 100% compatible with SQL Server on prem
- However, same administration requirements as on prem, e.g. backups
- You can "lift-and-shift" from on prem to the cloud - rapid deployemnt
- Hybrid development also available:
    - SQL Server in cloud
    - Other resources on prem 
- Quickly resize Virtual Machine
- Access database using SQL Server Management Studio (SSMS)
